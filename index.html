<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- এই মেটা ট্যাগগুলো ক্যাশিং সমস্যা কমাতে সাহায্য করতে পারে -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Red Chilli</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* CSS কোড অপরিবর্তিত... */
        body { font-family: sans-serif; margin: 0; }
        /* ... বাকি সব CSS এখানে থাকবে ... */
    </style>
</head>
<body>
    <!-- HTML এর বাকি অংশ অপরিবর্তিত... -->
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script>
        console.log("App script started. Version: Final_Debug_1"); // ভার্সন চেক করার জন্য

        const firebaseConfig = {
            apiKey: "AIzaSyAIXpawpQH3yRozPbTzP7Tzm6IFsNVpAzQ",
            authDomain: "fake-earn-5d8bd.firebaseapp.com",
            databaseURL: "https://fake-earn-5d8bd-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "fake-earn-5d8bd",
            storageBucket: "fake-earn-5d8bd.firebasestorage.app",
            messagingSenderId: "763892818801",
            appId: "1:763892818801:web:ea1d0fe6a006616dbd8cd0"
        };

        try {
            firebase.initializeApp(firebaseConfig);
            console.log("Firebase Initialized Successfully.");
        } catch (e) {
            console.error("Firebase Initialization Error:", e);
        }
        
        const database = firebase.database();
        
        document.addEventListener('DOMContentLoaded', function () {
            console.log("DOM content fully loaded.");
            let tg = window.Telegram.WebApp;
            let currentUser;

            if (tg && tg.initData) {
                console.log("Running in Telegram environment.");
                currentUser = tg.initDataUnsafe.user;
                tg.ready();
            } else {
                console.warn("Running in Browser/Vercel. Using mock data.");
                currentUser = { id: 12345, first_name: "Test", last_name: "User", photo_url: "https://via.placeholder.com/50" };
            }
            
            // Setup User Info
            // ... (কোড অপরিবর্তিত) ...

            const mainContent = document.getElementById('main-content');
            const configRef = database.ref('config');
            console.log("Attempting to read from Firebase path: /config");

            configRef.on('value', (snapshot) => {
                console.log("Firebase 'value' event triggered.");
                const config = snapshot.val();
                
                if (snapshot.exists() && config) {
                    console.log("Config data found!", config);
                    renderPage('home', config); // Render home by default
                } else {
                    console.error("Config data NOT FOUND in Firebase at /config path.");
                    mainContent.innerHTML = `<div class="card" style="margin-top: 50px;"><h4>App configuration not found.</h4><p>Please contact support.</p></div>`;
                }
            }, (error) => {
                console.error("Firebase read failed! Permission error or network issue.", error);
                mainContent.innerHTML = `<div class="card" style="margin-top: 50px;"><h4>Database Read Error.</h4><p>Check database rules or network.</p></div>`;
            });

            // Navigation logic
            // ... (কোড অপরিবর্তিত) ...
        });

        function renderPage(pageName, config) {
            // ... (কোড অপরিবর্তিত) ...
        }
    </script>
</body>
</html>
